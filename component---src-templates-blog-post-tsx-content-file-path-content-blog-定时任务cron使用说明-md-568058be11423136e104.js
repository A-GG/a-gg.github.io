"use strict";(self.webpackChunkw1zd_lair=self.webpackChunkw1zd_lair||[]).push([[1227],{5662:function(e,n,a){a.r(n),a.d(n,{default:function(){return i}});var t=a(8453),l=a(6540);function s(e){const n=Object.assign({img:"img",h2:"h2",a:"a",span:"span",p:"p",blockquote:"blockquote",em:"em",ul:"ul",li:"li",strong:"strong",h3:"h3"},(0,t.RP)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.img,{src:"https://raw.githubusercontent.com/w1zd/image-hosting/main/img/2022/05/10/11-45-00-28024130c0135066048c989955be90e4-cover-cron-fb63c9.png",alt:""}),"\n",l.createElement(n.h2,{id:"cron-简介",style:{position:"relative"}},l.createElement(n.a,{href:"#cron-%E7%AE%80%E4%BB%8B","aria-label":"cron 简介 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Cron 简介"),"\n",l.createElement(n.p,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}})," 是类 Unix 系统中用于执行定时任务的工具，我们可以通过 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">cron</code>'}})," 在固定时间、日期、间隔下，运行定期任务（可以是命令和脚本）。",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">cron</code>'}})," 最常使用的是服务器运维和管理方向，当然也可用于其他地方，如：定期下载文件等。"),"\n",l.createElement(n.blockquote,null,"\n",l.createElement(n.p,null,"The origin of the name ",l.createElement(n.em,null,"cron")," is from the Greek word for time, χρόνος (",l.createElement(n.a,{href:"https://en.wikipedia.org/wiki/Chronos"},"chronos"),")."),"\n",l.createElement(n.p,null,"Cron 的名字来历是古希腊神话中代表时间的神 Chronos"),"\n"),"\n",l.createElement(n.h2,{id:"cron-使用",style:{position:"relative"}},l.createElement(n.a,{href:"#cron-%E4%BD%BF%E7%94%A8","aria-label":"cron 使用 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Cron 使用"),"\n",l.createElement(n.p,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crond</code>'}})," 可以理解为是用来执行定时任务的服务，而 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab</code>'}})," 则是用来管理定时任务的。"),"\n",l.createElement(n.p,null,"要使用 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}})," 我们首先得确保自己系统的 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crond</code>'}})," 守护进程在运行，如果没有，则执行运行命令（什么？你没安装，",l.createElement(n.a,{href:"https://google.com"},"点这儿"),")"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># 查看 crond 状态</span>\nsystemctl status  crond.service\n<span class="token comment"># 启动 crond</span>\nsystemctl start  crond.service</code></pre></div>'}}),"\n",l.createElement(n.p,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}})," 任务的管理工具 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab</code>'}})," ，使用格外简单："),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># crontab [选项]</span>\n\n<span class="token comment">#查看当前用户的 crontab，输入</span>\n<span class="token function">crontab</span> –l \n<span class="token comment"># 编辑 crontab</span>\n<span class="token function">crontab</span> –e \n<span class="token comment"># 删除 crontab</span>\n<span class="token function">crontab</span> –r  </code></pre></div>'}}),"\n",l.createElement(n.p,null,"我们直接 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab -e</code>'}})," 编辑当前用户的定时任务，这里需要用到 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}})," 的语法（先直接用后面会讲具体用法）"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># 当你执行了 crontab -e 之后，会自动调用VI编辑器打开一个空文件用作输入</span>\n<span class="token comment"># 我们直接输入下面这一行内容，然后:wq 保存退出即可</span>\n\n* * * * * <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span> <span class="token operator">>></span> ~/hello.txt</code></pre></div>'}}),"\n",l.createElement(n.p,null,"保存成功后，使用 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab -l</code>'}}),"，你会发现你的定时任务中已经多了一条，这条任务的作用就是每分钟向 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">~/hello.txt</code>'}}),"  中写入当前系统时间。"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token variable">$crontab</span> -l\n* * * * * <span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span> <span class="token operator">>></span> ~/hello.txt</code></pre></div>'}}),"\n",l.createElement(n.p,null,"静待一会儿，去查看",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">~/hello.txt</code>'}})," 你会发现已经有内容了，就意味着我们的定时任务ok啦。"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token variable">$cat</span> hello.txt\nThu Apr <span class="token number">29</span> <span class="token number">11</span>:07:01 CST <span class="token number">2021</span>\nThu Apr <span class="token number">29</span> <span class="token number">11</span>:08:01 CST <span class="token number">2021</span>\nThu Apr <span class="token number">29</span> <span class="token number">11</span>:09:01 CST <span class="token number">2021</span>\nThu Apr <span class="token number">29</span> <span class="token number">11</span>:10:01 CST <span class="token number">2021</span>\nThu Apr <span class="token number">29</span> <span class="token number">11</span>:11:01 CST <span class="token number">2021</span></code></pre></div>'}}),"\n",l.createElement(n.p,null,"如果你不想要这个定时任务了，直接执行 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab -r</code>'}})," 即可，这里如果你只有一个任务，那就直接删掉了。如果你有多个任务，他会自动打开 vi，你只需要删掉不想要的那一行，保存退出即可。"),"\n",l.createElement(n.h2,{id:"cron-语法",style:{position:"relative"}},l.createElement(n.a,{href:"#cron-%E8%AF%AD%E6%B3%95","aria-label":"cron 语法 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Cron 语法"),"\n",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">┌──分钟（0 - <span class="token number">59</span>）\n│ ┌──小时（0 - <span class="token number">23</span>）\n│ │ ┌──日（1 - <span class="token number">31</span>）\n│ │ │ ┌─月（1 - <span class="token number">12</span>）\n│ │ │ │ ┌─星期（0 - <span class="token number">6</span>，表示从周日到周六）\n│ │ │ │ │\n*  *  *  *  * <span class="token operator">&lt;</span>被执行的命令<span class="token operator">></span></code></pre></div>'}}),"\n",l.createElement(n.p,null,"每部分的取值可以有如下表示方式："),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,"逗号（",l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">,</code>'}})),"）表示列举，例如： ",l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">1,3,4,7 * * * * echo hello world</code>'}})),' 表示，在每小时的1、3、4、7分时，打印"hello world"。'),"\n",l.createElement(n.li,null,"中划线（",l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">-</code>'}})),"）表示范围，例如：",l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">1-6 * * * * echo hello world</code>'}})),' ，表示，每小时的1到6分钟内，每分钟都会打印"hello world"。'),"\n",l.createElement(n.li,null,"星号（",l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">*</code>'}})),"）代表任何可能的值。例如：在“小时”里的星号等于是“每一个小时”。"),"\n",l.createElement(n.li,null,"百分号(",l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">%</code>'}})),') 表示“每"。例如：',l.createElement(n.strong,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">*%10 * * * * echo hello world</code>'}})),' 表示，每10分钟打印一回"hello world"。'),"\n"),"\n",l.createElement(n.h2,{id:"cron-注意事项这部分不是特别关键",style:{position:"relative"}},l.createElement(n.a,{href:"#cron-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E8%BF%99%E9%83%A8%E5%88%86%E4%B8%8D%E6%98%AF%E7%89%B9%E5%88%AB%E5%85%B3%E9%94%AE","aria-label":"cron 注意事项这部分不是特别关键 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"Cron 注意事项(这部分不是特别关键)"),"\n",l.createElement(n.h3,{id:"执行权限问题",style:{position:"relative"}},l.createElement(n.a,{href:"#%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98","aria-label":"执行权限问题 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"执行权限问题"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"/etc/cron.allow")," 如果这个文件存在，那么只有被添加到这个文件中的用户才能使用 cron"),"\n",l.createElement(n.li,null,l.createElement(n.strong,null,"/etc/cron.deny")," 如果 ",l.createElement(n.strong,null,"/etc/cron.allow")," 不存在，但是这个文件存在，那么用户不在这个文件里才能使用cron"),"\n"),"\n",l.createElement(n.h3,{id:"定时任务查找位置",style:{position:"relative"}},l.createElement(n.a,{href:"#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%9F%A5%E6%89%BE%E4%BD%8D%E7%BD%AE","aria-label":"定时任务查找位置 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"定时任务查找位置"),"\n",l.createElement(n.ul,null,"\n",l.createElement(n.li,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/crontab</code>'}}),"：为系统任务时间表（crontab）。以前用于跑以日为单位、以周为单位、以月为单位的任务，现在用于跑 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">anacron</code>'}}),"。"),"\n",l.createElement(n.li,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/etc/cron.d/</code>'}}),"：该目录包含系统层次的任务时间表（crontabs），不同用户共同使用。"),"\n",l.createElement(n.li,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">/var/spool/cron/</code>'}}),"：该路径包含用户通过 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab</code>'}})," 命令创建的任务时间表（crontables），这个不要手动去改哦，要改就通过 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">crontab</code>'}})," 命令改。"),"\n"),"\n",l.createElement(n.h2,{id:"总结",style:{position:"relative"}},l.createElement(n.a,{href:"#%E6%80%BB%E7%BB%93","aria-label":"总结 permalink",className:"anchor before"},l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"总结"),"\n",l.createElement(n.p,null,l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}})," 可以非常方便的帮我们在 Linux 系统中执行定时任务，还有很多其他有周期任务需求的系统中也都支持 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}})," 语法，比如我前面写过的[[GithubActions入门]]，如果你想定时执行你的 Github Action 就可以使用 ",l.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Cron</code>'}}),"。"))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,t.RP)(),e.components);return n?l.createElement(n,e,l.createElement(s,e)):s(e)},r=a(1468),o=a(7947),m=a(1327),p=a(2171),h=a(9739);const d=e=>{let{data:n,pageContext:a,children:s}=e;const c=n.mdx,{title:d,postCopyright:i,author:g,siteUrl:u}=n.site.siteMetadata,{previous:E,next:b}=a,v=(0,r.d4)((e=>e.isDarkMode));return(0,l.useEffect)((()=>{(0,h.A)(".post-content img",{background:"#292a2d"})}),[]),l.createElement(o.A,{isFocus:!1,title:c.frontmatter.title,description:c.frontmatter.description},l.createElement("div",{className:"container"},l.createElement("article",{className:"post-wrap"},l.createElement("header",{className:"post-header"},l.createElement("h1",{className:"post-title"},c.frontmatter.title),l.createElement("div",{className:"post-meta"},l.createElement("span",{className:"post-time"},c.frontmatter.date)," ")),l.createElement("div",{className:"post-content"},l.createElement(t.xA,null,s)),i&&l.createElement("section",{className:"post-copyright"},l.createElement("p",{className:"copyright-item"},l.createElement("span",null,"Author: "),l.createElement("span",null,g.name)),l.createElement("p",{className:"copyright-item"},l.createElement("span",null,"Permalink:"),l.createElement("span",null,l.createElement("a",{href:u+c.fields.slug}," ",u+c.fields.slug," "))),l.createElement("p",{className:"copyright-item"},l.createElement("span",null,"License: "),l.createElement("span",null,l.createElement("a",{href:"http://creativecommons.org/licenses/by-nc/4.0/"},"CC-BY-NC-4.0")))),l.createElement("section",{className:"post-tags"},l.createElement("div",null,l.createElement("span",null,"Tag(s):"),l.createElement("span",{className:"tag"},0!==c.frontmatter.tags.length&&c.frontmatter.tags.map((e=>l.createElement("a",{key:e,href:`/tag/${e}`},"#",e))))),l.createElement("div",null,l.createElement("a",{href:"#/",onClick:()=>{window.history.back()}},"back"),l.createElement("span",null," · "),l.createElement("a",{href:n.site.siteMetadata.siteUrl},"home"))),l.createElement("section",{className:"post-nav"},E?l.createElement("a",{className:"prev",rel:"prev",href:E.fields.slug},E.frontmatter.title):l.createElement("span",{className:"prev"},"No More"),b?l.createElement("a",{className:"next",rel:"next",href:b.fields.slug},b.frontmatter.title):l.createElement("span",{className:"next"},"No More")),l.createElement(p.A,{id:"comment",repo:"w1zd/w1zd.github.io",repoId:"MDEwOlJlcG9zaXRvcnkyODg3MTA5NjA=",category:"Announcements",categoryId:"MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDE1OTcy",mapping:"og:title",theme:`https://wizd.dev/giscus-themes/${v?"dark":"light"}.css`,reactionsEnabled:"1",loading:"lazy"}),c.frontmatter.toc&&l.createElement(m.A,null))))};function i(e){return l.createElement(d,e,l.createElement(c,e))}}}]);
//# sourceMappingURL=component---src-templates-blog-post-tsx-content-file-path-content-blog-定时任务cron使用说明-md-568058be11423136e104.js.map