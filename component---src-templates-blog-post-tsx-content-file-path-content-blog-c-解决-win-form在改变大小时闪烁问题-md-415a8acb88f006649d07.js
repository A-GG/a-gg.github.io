"use strict";(self.webpackChunkw1zd_lair=self.webpackChunkw1zd_lair||[]).push([[5324],{2547:function(e,a,t){t.r(a),t.d(a,{default:function(){return h}});var n=t(8453),s=t(6540);function l(e){const a=Object.assign({h2:"h2",a:"a",span:"span",p:"p"},(0,n.RP)(),e.components);return s.createElement(s.Fragment,null,s.createElement(a.h2,{id:"问题发现",style:{position:"relative"}},s.createElement(a.a,{href:"#%E9%97%AE%E9%A2%98%E5%8F%91%E7%8E%B0","aria-label":"问题发现 permalink",className:"anchor before"},s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"问题发现"),"\n",s.createElement(a.p,null,"最近写WinForm程序的时候遇见一个问题，就是在拖动窗体改变大小的时候，窗体闪烁会非常严重。"),"\n",s.createElement(a.p,null,"网上找的解决方案都是说用",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">双缓冲</code>'}}),"进行处理。"),"\n",s.createElement(a.h2,{id:"双缓冲",style:{position:"relative"}},s.createElement(a.a,{href:"#%E5%8F%8C%E7%BC%93%E5%86%B2","aria-label":"双缓冲 permalink",className:"anchor before"},s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"双缓冲"),"\n",s.createElement(a.p,null,"在图形图像处理编程过程中，双缓冲是一种基本的技术，如果窗体在响应OnPaint事件的时候要进行复杂的图形处理，那么窗体在重绘的时候由于过频的刷新而引起闪烁现象。\n使用双缓冲时，更新的图形首先被绘制到内存的缓冲区中，然后，此缓冲区的内容被迅速写入某些或所有显示的图面中。"),"\n",s.createElement(a.p,null,"双缓冲实现过程如下：\n1、在内存中创建与画布一致的缓冲区\n2、在缓冲区画图\n3、将缓冲区位图拷贝到当前画布上\n4、释放内存缓冲区"),"\n",s.createElement(a.h2,{id:"没用的方案",style:{position:"relative"}},s.createElement(a.a,{href:"#%E6%B2%A1%E7%94%A8%E7%9A%84%E6%96%B9%E6%A1%88","aria-label":"没用的方案 permalink",className:"anchor before"},s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"没用的方案"),"\n",s.createElement(a.p,null,"下面列出来比较多见的一种做法："),"\n",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">SetStyle</span><span class="token punctuation">(</span>ControlStyles<span class="token punctuation">.</span>OptimizedDoubleBuffer <span class="token operator">|</span> 　　\n                  ControlStyles<span class="token punctuation">.</span>ResizeRedraw <span class="token operator">|</span>\n                  ControlStyles<span class="token punctuation">.</span>AllPaintingInWmPaint<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(a.p,null,"但是这样写之后，状况并没有太大的改善，在拖动窗体大小的时候，闪烁情况依旧非常明显。"),"\n",s.createElement(a.h2,{id:"有用的方案createparams",style:{position:"relative"}},s.createElement(a.a,{href:"#%E6%9C%89%E7%94%A8%E7%9A%84%E6%96%B9%E6%A1%88createparams","aria-label":"有用的方案createparams permalink",className:"anchor before"},s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>'}})),"有用的方案(CreateParams)"),"\n",s.createElement(a.p,null,"使用双缓冲之后并没有什么收获，所以，费劲九牛二虎之力的我找到了",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">CreateParams</code>'}}),"这个东西。"),"\n",s.createElement(a.p,null,"窗体和控件的属性",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">CreateParams</code>'}}),"（这真的是一个属性）很神奇，因为通过它你能够很方便的控制窗体或控件诸如边框、最大化最小化关闭按钮的隐藏、窗体的模式化弹窗模式等的一些特性。"),"\n",s.createElement(a.p,null,"那具体怎么操作呢？"),"\n",s.createElement(a.p,null,"在主窗体的任意位置重写CreateParams，便能大幅改善闪烁的状况，代码如下："),"\n",s.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="csharp"><pre class="language-csharp"><code class="language-csharp"><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name">CreateParams</span> CreateParams\n<span class="token punctuation">{</span>\n    <span class="token keyword">get</span>\n    <span class="token punctuation">{</span>\n        <span class="token class-name">CreateParams</span> cp <span class="token operator">=</span> <span class="token keyword">base</span><span class="token punctuation">.</span>CreateParams<span class="token punctuation">;</span>\n        cp<span class="token punctuation">.</span>ExStyle <span class="token operator">|=</span> <span class="token number">0x02000000</span><span class="token punctuation">;</span><span class="token comment">////用双缓冲绘制窗口的所有子控件</span>\n        <span class="token keyword">return</span> cp<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre></div>'}}))}var c=function(e){void 0===e&&(e={});const{wrapper:a}=Object.assign({},(0,n.RP)(),e.components);return a?s.createElement(a,e,s.createElement(l,e)):l(e)},r=t(1468),o=t(7947),p=t(1327),i=t(2171),m=t(9739);const u=e=>{let{data:a,pageContext:t,children:l}=e;const c=a.mdx,{title:u,postCopyright:h,author:d,siteUrl:E}=a.site.siteMetadata,{previous:g,next:k}=t,f=(0,r.d4)((e=>e.isDarkMode));return(0,s.useEffect)((()=>{(0,m.A)(".post-content img",{background:"#292a2d"})}),[]),s.createElement(o.A,{isFocus:!1,title:c.frontmatter.title,description:c.frontmatter.description},s.createElement("div",{className:"container"},s.createElement("article",{className:"post-wrap"},s.createElement("header",{className:"post-header"},s.createElement("h1",{className:"post-title"},c.frontmatter.title),s.createElement("div",{className:"post-meta"},a.site.siteMetadata.author.name,"  /  ",s.createElement("span",{className:"post-time"},c.frontmatter.date)," ")),s.createElement("div",{className:"post-content"},s.createElement(n.xA,null,l)),h&&s.createElement("section",{className:"post-copyright"},s.createElement("p",{className:"copyright-item"},s.createElement("span",null,"Author: "),s.createElement("span",null,d.name)),s.createElement("p",{className:"copyright-item"},s.createElement("span",null,"Permalink:"),s.createElement("span",null,s.createElement("a",{href:E+c.fields.slug}," ",E+c.fields.slug," "))),s.createElement("p",{className:"copyright-item"},s.createElement("span",null,"License: "),s.createElement("span",null,s.createElement("a",{href:"http://creativecommons.org/licenses/by-nc/4.0/"},"CC-BY-NC-4.0")))),s.createElement("section",{className:"post-tags"},s.createElement("div",null,s.createElement("span",null,"Tag(s):"),s.createElement("span",{className:"tag"},0!==c.frontmatter.tags.length&&c.frontmatter.tags.map((e=>s.createElement("a",{key:e,href:`/tag/${e}`},"#",e))))),s.createElement("div",null,s.createElement("a",{href:"#/",onClick:()=>{window.history.back()}},"back"),s.createElement("span",null," · "),s.createElement("a",{href:a.site.siteMetadata.siteUrl},"home"))),s.createElement("section",{className:"post-nav"},g?s.createElement("a",{className:"prev",rel:"prev",href:g.fields.slug},g.frontmatter.title):s.createElement("span",{className:"prev"},"No More"),k?s.createElement("a",{className:"next",rel:"next",href:k.fields.slug},k.frontmatter.title):s.createElement("span",{className:"next"},"No More")),s.createElement(i.A,{id:"comment",repo:"w1zd/w1zd.github.io",repoId:"MDEwOlJlcG9zaXRvcnkyODg3MTA5NjA=",category:"Announcements",categoryId:"MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMzMDE1OTcy",mapping:"og:title",theme:`https://wizd.dev/giscus-themes/${f?"dark":"light"}.css`,reactionsEnabled:"1",loading:"lazy"}),c.frontmatter.toc&&s.createElement(p.A,null))))};function h(e){return s.createElement(u,e,s.createElement(c,e))}}}]);
//# sourceMappingURL=component---src-templates-blog-post-tsx-content-file-path-content-blog-c-解决-win-form在改变大小时闪烁问题-md-415a8acb88f006649d07.js.map