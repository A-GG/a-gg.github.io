{"componentChunkName":"component---src-templates-blog-post-tsx-content-file-path-content-blog-asp-net-mvc给母版页传递数据-md","path":"/ASP-NET-MVC给母版页传递数据/","result":{"data":{"site":{"siteMetadata":{"title":"Wizard's Lair","postCopyright":true,"siteUrl":"https://wizd.dev","author":{"name":"w1zd"}}},"mdx":{"id":"13b676ab-7dab-5878-b5d8-896f9ce74360","excerpt":"在MVC中，我们会遇到这样的场景： 每一页中需要都显示地区信息，这些地区信息都是存储在数据库当中的。\n 为了方便使用，我们将地区信息在模板页中显示，问题来了，怎么在视图母版页面里从数据库检索这些地区信息？\n\n直接在视图中操作数据库检索数据？\n\n这样的确很方便，但是这样就违反了MVC的设计初衷，，就是为了将关注点进行分离…","body":">在MVC中，我们会遇到这样的场景：  \n每一页中需要都显示地区信息，这些地区信息都是存储在数据库当中的。  \n为了方便使用，我们将地区信息在模板页中显示，问题来了，怎么在视图母版页面里从数据库检索这些地区信息？\n\n## 直接在视图中操作数据库检索数据？\n\n这样的确很方便，但是这样就违反了MVC的设计初衷，`Model-View-Controller`，就是为了将关注点进行分离，当然这也是`MVC`的优点之一。\n\n在MVC中，所有的Model的传递和交换都应该由`Controller`来进行，这样做会加强系统的可维护性以及可扩展性。也就是说所有传往视图的数据都应该由控制器来控制。\n\n那这么说来，我们应该如何将数据传递到母版页视图（_Layout.cshtml）呢？\n\n## 方法一：\n我们可以在控制器内的每个方法中，为母版页传递数据！\n也就是说在控制器的没个方法中给ViewData进行赋值。这么做确实能实现，但是每个方法内都要写这么一段代码。\n问题在于：DRY！\n**Don’t Repeat Yourself！**\n每一个方法内都加一段读取数据的代码会提高程序的复杂度，造成后续的维护困难，那我们应该怎么做呢，别着急，往下看！\n## 方法二：\n既然不能这么重复的写代码，那我们就换个思路。\n因为我们只需要对母版页视图传递一次数据就好了。\n那我们就将从数据库中读取数据的操作放在控制器的构造方法中，这样就避免了要在每个方法中都加上相同的代码。\n但是这样之后，细心的同学又会发现，那岂不是我每个控制器的构造方法中都需要加上这么一段代码，还是违反了DRY。\n没错，那么这里我们就要用到面向对象的特性：封装、继承、多态中的继承。\n我们可以定义一个抽象类`BaseController`，让`BaseController`继承于`System.Web.Mvc.Controller`。\n然后在`BaseController`的构造方法中，我们对`ViewData`进行赋值。\n在项目中其他的控制器里，我们让控制器继承于`BaseController`，那么我们的问题就解决了。\n有人可能会问，为什么要用抽象类呢？\n因为，我们这个类需要做的工作只是为母版页加载数据，并没有相对应的其他操作。设置为抽象类可以防止其他类直接调用该类中的方法。\n到这里，我们需要给母版页传值的问题已经解决了。\n","fields":{"slug":"/ASP-NET-MVC给母版页传递数据/"},"frontmatter":{"title":"ASP.NET MVC给母版页传递数据","date":"March 31, 2014","description":"如果在当前页和母版页之间相互传递数据呢？本篇主要讲解如何在母版页内给其他页面传递数据！","categories":["技术文章"],"tags":[".NET","CSharp","ASP.NET"],"toc":true}}},"pageContext":{"slug":"/ASP-NET-MVC给母版页传递数据/","previous":{"internal":{"contentFilePath":"/home/runner/work/w1zd.github.io/w1zd.github.io/content/blog/WordPress插件安装时Missing-archive-file.md"},"fields":{"slug":"/WordPress插件安装时Missing-archive-file/"},"frontmatter":{"title":"WordPress插件安装时Missing archive file"}},"next":{"internal":{"contentFilePath":"/home/runner/work/w1zd.github.io/w1zd.github.io/content/blog/C-解决WinForm在改变大小时闪烁问题.md"},"fields":{"slug":"/C-解决WinForm在改变大小时闪烁问题/"},"frontmatter":{"title":"C#解决WinForm在改变大小时闪烁问题"}},"frontmatter":{"title":"ASP.NET MVC给母版页传递数据","date":"2014-03-31T14:38:42.284Z","tags":[".NET","CSharp","ASP.NET"],"categories":["技术文章"],"description":"如果在当前页和母版页之间相互传递数据呢？本篇主要讲解如何在母版页内给其他页面传递数据！","toc":true}}},"staticQueryHashes":["2786614800","3000541721","3828236571"],"slicesMap":{}}